
‚úÖ Adjusted Trial Balance Generation Prompt *(Updated for Intercompany Elimination Adjustments)*

Purpose:
Generate an adjusted trial balance Excel file with detailed intercompany elimination adjustments, including client-provided entries for March 2025. This ensures accurate financial reporting by eliminating intercompany transactions in compliance with GAAP.

---

üõ†Ô∏è Required Inputs
- Unadjusted Trial Balance File Name: "Trial_Balance.xlsx"
- Source Adjustment File Name: "InterCompanyExtract.xlsx"
- Type of Adjustment: "Intercompany Elimination Adjustments"

---

üß† Processing Logic Enhancements

- GL Code Normalization:
  All GL Codes from both files are converted to string format and stripped of whitespace to ensure accurate merging.

- Handling Duplicate Column Names:
  If the intercompany file contains multiple columns with the same name (e.g., "GL Code"), disambiguate them by renaming (e.g., "GL Code_1", "GL Code_2").
  Use the first occurrence of "GL Code", "Dr", and "Cr" for adjustments.
  This should be done programmatically by scanning the header row and renaming duplicates using a counter-based suffix.

- Column Indexing for Adjustments:
  Adjustment entries are extracted using the first set of columns:
  - 'GL Code': General Ledger Code
  - 'Dr': Debit amount
  - 'Cr': Credit amount

- Data Cleaning:
  Non-numeric adjustment values are coerced to NaN and dropped to avoid calculation errors.

- Accurate Matching:
  Adjustments are grouped by GL Code and summed before merging with the trial balance.
  Note: Ensure the GL account description column is referenced as 'GL Code Description ' (with trailing space) to avoid KeyError during merging and when identifying unmatched GL Codes.

---

üìä Output Format

| Column                     | Description                                               |
|---------------------------|-----------------------------------------------------------|
| GL Code                   | General Ledger Code                                       |
| Account Name              | Description of the GL Account                             |
| Balance Before Adjustment (MYR) | Original balance from trial balance               |
| Debit                     | Sum of positive adjustments                               |
| Credit                    | Sum of negative adjustments                               |
| Net Adjustment            | Debit - Credit                                            |
| Interco Adjustment Entries| Debit - Credit                                            |
| Adjusted Balance (MYR)    | Final adjusted balance after applying net adjustment      |

Example Row:
11010000 | Trademark | 0 | 0 | 0 | 0 | 0 | 0

---

üìÑ Additional Features

Second Sheet: Adjustment Summary
- Adjustment Type
- Date Processed
- Total GL Codes Adjusted
- Net Adjustment Amount
- Unmatched GL Codes list (identified using 'GL Code Description ' column and converted to string before writing to Excel to avoid errors)

Formatting:
- Thousand separators
- Rounded to 2 decimals
- Bold headers
- Filters and frozen top row

---

üìÅ Output File Naming Convention

Filename Format:
Adjusted_Trial_Balance_ICIAEA_<YYYYMMDD_HHMMSS>.xlsx
(e.g., Adjusted_Trial_Balance_ICIAEA_20251015_164741.xlsx)
Uses current date and time stamp at the moment of file creation.
